============================================================
–í–µ–± –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ 
============================================================

–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å
--------------------------------------
–í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã –æ–±—ä–µ–¥–∏–Ω–∏–º –º–∞—Ç—Ä–∏—á–Ω—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –≤–µ–±-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏, —Å–æ–∑–¥–∞–≤ —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª–∏—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä. –¢–∞–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–¥–æ–≤—ã—Ö –∑–∞–º–∫–æ–≤, —Å–∏—Å—Ç–µ–º –≤–≤–æ–¥–∞ PIN-–∫–æ–¥–æ–≤, –ø—Ä–æ—Å—Ç—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –º–Ω–æ–≥–∏—Ö –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –≤–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö —Å —É–¥–∞–ª–µ–Ω–Ω—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º.

–ú–∞—Ç—Ä–∏—á–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ 4x4 —Å–æ–¥–µ—Ä–∂–∏—Ç 16 –∫–Ω–æ–ø–æ–∫, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –≤—Å–µ–≥–æ 8 GPIO –ø–∏–Ω–æ–≤ –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–≤–æ–µ–π –º–∞—Ç—Ä–∏—á–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏. –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- Flask –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
- CircuitPython –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
- JavaScript –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ–ø—Ä–æ—Å–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –≤–µ–±-–∑–∞–ø—Ä–æ—Å–æ–≤

–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
------------------------------------------------------------
- Raspberry Pi
- –ú–∞—Ç—Ä–∏—á–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ 4x4
- –°–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–æ–¥–∞
- –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å –±—Ä–∞—É–∑–µ—Ä–æ–º –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É (—Å–º–∞—Ä—Ç—Ñ–æ–Ω, –ø–ª–∞–Ω—à–µ—Ç, –∫–æ–º–ø—å—é—Ç–µ—Ä)

–°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
-------------------------------------------------------
.. figure:: images/keypad_matrix.png
   :width: 80%
   :align: center

   **–†–∏—Å. 1:** –°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –º–∞—Ç—Ä–∏—á–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã 4x4

–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –∫ Raspberry Pi —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
- –°—Ç—Ä–æ–∫–∏ (R1-R4) –∫ GPIO –ø–∏–Ω–∞–º: 5, 6, 13, 19
- –°—Ç–æ–ª–±—Ü—ã (C1-C4) –∫ GPIO –ø–∏–Ω–∞–º: 12, 16, 20, 21

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
---------------------------------------------------------------------
–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –∫–æ–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

.. code-block:: bash

   pip install flask adafruit-circuitpython-matrixkeypad

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
-------------------------------------------------------
–°–æ–∑–¥–∞–π—Ç–µ —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ –∏ —Ñ–∞–π–ª–æ–≤:

.. code-block:: bash

   lessons/
   ‚îî‚îÄ‚îÄ keypad_web/
       ‚îú‚îÄ‚îÄ app.py            # –û—Å–Ω–æ–≤–Ω–æ–µ Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
       ‚îî‚îÄ‚îÄ templates/
           ‚îî‚îÄ‚îÄ index.html    # HTML-—à–∞–±–ª–æ–Ω –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

–ö–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã
---------------------------------------------------
**–§–∞–π–ª app.py**

.. code-block:: python

   from flask import Flask, render_template, jsonify
   import time
   import board
   import digitalio
   import adafruit_matrixkeypad
   import threading

   app = Flask(__name__)

   # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–∏–Ω—ã –¥–ª—è —Å—Ç—Ä–æ–∫ (R1-R4) –∏ —Å—Ç–æ–ª–±—Ü–æ–≤ (C1-C4)
   row_pins = [
       digitalio.DigitalInOut(board.D5),
       digitalio.DigitalInOut(board.D6),
       digitalio.DigitalInOut(board.D13),
       digitalio.DigitalInOut(board.D19)
   ]

   col_pins = [
       digitalio.DigitalInOut(board.D12),
       digitalio.DigitalInOut(board.D16),
       digitalio.DigitalInOut(board.D20),
       digitalio.DigitalInOut(board.D21)
   ]

   # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–∏–Ω—ã —Å—Ç—Ä–æ–∫ –∫–∞–∫ –≤—ã—Ö–æ–¥—ã —Å –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏–µ–º –∫ –≤—ã—Å–æ–∫–æ–º—É —É—Ä–æ–≤–Ω—é
   for pin in row_pins:
       pin.direction = digitalio.Direction.OUTPUT
       pin.value = True

   # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–∏–Ω—ã —Å—Ç–æ–ª–±—Ü–æ–≤ –∫–∞–∫ –≤—Ö–æ–¥—ã —Å –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏–µ–º –∫ –≤—ã—Å–æ–∫–æ–º—É —É—Ä–æ–≤–Ω—é
   for pin in col_pins:
       pin.direction = digitalio.Direction.INPUT
       pin.pull = digitalio.Pull.UP

   # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ä—Ç—É —Å–∏–º–≤–æ–ª–æ–≤ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
   keys = [
       ["1", "2", "3", "A"],
       ["4", "5", "6", "B"],
       ["7", "8", "9", "C"],
       ["*", "0", "#", "D"]
   ]

   # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—á–Ω—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
   keypad = adafruit_matrixkeypad.Matrix_Keypad(
       row_pins, col_pins, keys
   )

   # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
   current_input = ""  # –¢–µ–∫—É—â–∏–π –≤–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   last_pressed = []   # –ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–∞–∂–∞—Ç—ã–µ –∫–ª–∞–≤–∏—à–∏
   keypad_history = [] # –ò—Å—Ç–æ—Ä–∏—è –≤–≤–æ–¥–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

   # –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
   lock = threading.Lock()

   # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à
   def process_key_press(key):
       global current_input, keypad_history
       
       with lock:
           if key == "*":  # –ï—Å–ª–∏ –Ω–∞–∂–∞—Ç–∞ –∑–≤–µ–∑–¥–æ—á–∫–∞, –æ—á–∏—â–∞–µ–º –≤–≤–æ–¥
               keypad_history.append(f"–í–≤–æ–¥ –æ—á–∏—â–µ–Ω: {current_input}")
               current_input = ""
           elif key == "#":  # –ï—Å–ª–∏ –Ω–∞–∂–∞—Ç–∞ —Ä–µ—à–µ—Ç–∫–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–≤–æ–¥
               keypad_history.append(f"–ü–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω –≤–≤–æ–¥: {current_input}")
               current_input = ""
           else:  # –û–±—ã—á–Ω–∞—è –∫–ª–∞–≤–∏—à–∞ - –¥–æ–±–∞–≤–ª—è–µ–º –∫ —Ç–µ–∫—É—â–µ–º—É –≤–≤–æ–¥—É
               current_input += key
               keypad_history.append(f"–ù–∞–∂–∞—Ç–∞ –∫–ª–∞–≤–∏—à–∞: {key}")
           
           # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –¥–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 20 –∑–∞–ø–∏—Å–µ–π
           if len(keypad_history) > 20:
               keypad_history = keypad_history[-20:]

   # –§—É–Ω–∫—Ü–∏—è –æ–ø—Ä–æ—Å–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
   def keypad_polling():
       global last_pressed
       
       while True:
           # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–∂–∞—Ç—ã–µ –∫–ª–∞–≤–∏—à–∏
           pressed = keypad.pressed_keys
           
           # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –Ω–∞–∂–∞—Ç–∏—è
           for key in pressed:
               if key not in last_pressed:
                   process_key_press(key)
           
           # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –Ω–∞–∂–∞—Ç—ã—Ö –∫–ª–∞–≤–∏—à
           last_pressed = pressed.copy()
           
           # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏
           time.sleep(0.1)

   # –†–æ—É—Ç –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   @app.route('/')
   def index():
       return render_template('index.html')

   # API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
   @app.route('/api/keypad-state')
   def keypad_state():
       with lock:
           return jsonify({
               'current_input': current_input,
               'history': keypad_history
           })

   # –ó–∞–ø—É—Å–∫ –æ–ø—Ä–æ—Å–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
   def start_keypad_thread():
       keypad_thread = threading.Thread(target=keypad_polling, daemon=True)
       keypad_thread.start()

   if __name__ == '__main__':
       # –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ—Ç–æ–∫ –¥–ª—è –æ–ø—Ä–æ—Å–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
       start_keypad_thread()
       
       # –ó–∞–ø—É—Å–∫–∞–µ–º –≤–µ–±-—Å–µ—Ä–≤–µ—Ä Flask
       app.run(host='0.0.0.0', port=5000, debug=False, threaded=True)

**–§–∞–π–ª templates/index.html**

.. code-block:: html

   <!DOCTYPE html>
   <html lang="ru">
   <head>
       <meta charset="UTF-8">
       <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <title>–ú–∞—Ç—Ä–∏—á–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞</title>
       <style>
           body {
               font-family: Arial, sans-serif;
               margin: 0;
               padding: 20px;
               max-width: 800px;
               margin: 0 auto;
           }
           h1 {
               text-align: center;
               margin-bottom: 20px;
           }
           .container {
               display: flex;
               flex-direction: column;
               gap: 20px;
           }
           .panel {
               border: 1px solid #ddd;
               border-radius: 5px;
               padding: 15px;
               background-color: #f9f9f9;
           }
           .input-display {
               font-size: 24px;
               text-align: center;
               padding: 10px;
               background-color: #333;
               color: #fff;
               border-radius: 5px;
               font-family: monospace;
               letter-spacing: 2px;
               height: 40px;
               line-height: 40px;
           }
           .history {
               height: 300px;
               overflow-y: auto;
               border: 1px solid #ccc;
               padding: 10px;
               background-color: #fff;
           }
           .history-item {
               padding: 5px;
               border-bottom: 1px solid #eee;
           }
           .history-item:nth-child(odd) {
               background-color: #f5f5f5;
           }
           .keypad-instruction {
               text-align: center;
               color: #666;
               font-style: italic;
           }
       </style>
   </head>
   <body>
       <h1>–ú–∞—Ç—Ä–∏—á–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ 4x4</h1>
       
       <div class="container">
           <div class="panel">
               <h2>–¢–µ–∫—É—â–∏–π –≤–≤–æ–¥:</h2>
               <div class="input-display" id="current-input">_</div>
               <p class="keypad-instruction">* - –æ—á–∏—Å—Ç–∏—Ç—å –≤–≤–æ–¥, # - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤–≤–æ–¥</p>
           </div>
           
           <div class="panel">
               <h2>–ò—Å—Ç–æ—Ä–∏—è –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à:</h2>
               <div class="history" id="history"></div>
           </div>
       </div>
       <script>
           // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞
           function updateKeypadData() {
               fetch('/api/keypad-state')
                   .then(response => response.json())
                   .then(data => {
                       // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –≤–≤–æ–¥
                       const inputDisplay = document.getElementById('current-input');
                       inputDisplay.textContent = data.current_input || '_';
                       
                       // –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é –Ω–∞–∂–∞—Ç–∏–π
                       const historyContainer = document.getElementById('history');
                       historyContainer.innerHTML = '';
                       
                       // –î–æ–±–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∏—Å—Ç–æ—Ä–∏–∏ –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
                       data.history.slice().reverse().forEach(item => {
                           const historyItem = document.createElement('div');
                           historyItem.className = 'history-item';
                           historyItem.textContent = item;
                           historyContainer.appendChild(historyItem);
                       });
                   })
                   .catch(error => {
                       console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error);
                   });
           }
           
           // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
           updateKeypadData();
           
           // –ó–∞—Ç–µ–º –æ–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
           setInterval(updateKeypadData, 1000);
       </script>
   </body>
   </html>

–†–∞–∑–±–æ—Ä –∫–æ–¥–∞
-------------------------------------------------

**–†–∞–∑–±–æ—Ä app.py:**

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∏–Ω–æ–≤ –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã:**

.. code-block:: python

    row_pins = [digitalio.DigitalInOut(board.D5), ...]
    col_pins = [digitalio.DigitalInOut(board.D12), ...]
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∏–Ω–æ–≤ —Å—Ç—Ä–æ–∫ –∫–∞–∫ –≤—ã—Ö–æ–¥—ã

    for pin in row_pins:
        pin.direction = digitalio.Direction.OUTPUT
        pin.value = True
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∏–Ω–æ–≤ —Å—Ç–æ–ª–±—Ü–æ–≤ –∫–∞–∫ –≤—Ö–æ–¥—ã —Å –ø–æ–¥—Ç—è–∂–∫–æ–π
    for pin in col_pins:
        pin.direction = digitalio.Direction.INPUT
        pin.pull = digitalio.Pull.UP


   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º GPIO –ø–∏–Ω—ã –¥–ª—è —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –º–∞—Ç—Ä–∏—á–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
   - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫–∏ –∫–∞–∫ –≤—ã—Ö–æ–¥—ã, –∞ —Å—Ç–æ–ª–±—Ü—ã –∫–∞–∫ –≤—Ö–æ–¥—ã —Å –ø–æ–¥—Ç—è–∂–∫–æ–π –∫ –≤—ã—Å–æ–∫–æ–º—É —É—Ä–æ–≤–Ω—é

2. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã —Å–∏–º–≤–æ–ª–æ–≤:**

.. code-block:: python

    keys = [
        ["1", "2", "3", "A"],
        ["4", "5", "6", "B"],
        ["7", "8", "9", "C"],
        ["*", "0", "#", "D"]
    ]
  
   - –°–æ–∑–¥–∞–µ–º –º–∞—Ç—Ä–∏—Ü—É —Å–∏–º–≤–æ–ª–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º—É —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—é –∫–ª–∞–≤–∏—à

3. **–†–∞–±–æ—Ç–∞ —Å –Ω–∞–∂–∞—Ç–∏—è–º–∏ –∫–ª–∞–≤–∏—à:**

    .. code-block:: python

        def process_key_press(key):
            global current_input, keypad_history
            
            with lock:
                if key == "*":  # –û—á–∏—Å—Ç–∫–∞ –≤–≤–æ–¥–∞
                    keypad_history.append(f"–í–≤–æ–¥ –æ—á–∏—â–µ–Ω: {current_input}")
                    current_input = ""
                elif key == "#":  # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–≤–æ–¥–∞
                    keypad_history.append(f"–ü–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω –≤–≤–æ–¥: {current_input}")
                    current_input = ""
                else:  # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–∞
                    current_input += key
                    keypad_history.append(f"–ù–∞–∂–∞—Ç–∞ –∫–ª–∞–≤–∏—à–∞: {key}")

   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –Ω–∞–∂–∞—Ç–∏—è —Ä–∞–∑–Ω—ã—Ö –∫–ª–∞–≤–∏—à
   - –ò—Å–ø–æ–ª—å–∑—É–µ–º `*` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –≤–≤–æ–¥–∞ –∏ `#` –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
   - –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ç–æ—Ä–∏—é –¥–µ–π—Å—Ç–≤–∏–π

4. **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å:**

    .. code-block:: python

        def keypad_polling():
            global last_pressed
            
            while True:
                pressed = keypad.pressed_keys
                
                for key in pressed:
                    if key not in last_pressed:
                        process_key_press(key)
                
                last_pressed = pressed.copy()
                time.sleep(0.1)

   - –°–æ–∑–¥–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –æ–ø—Ä–æ—Å–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –Ω–∞–∂–∞—Ç–∏—è, —Å—Ä–∞–≤–Ω–∏–≤–∞—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
   - –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É (`lock`) –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—â–∏–º –¥–∞–Ω–Ω—ã–º

5. **Flask API:**

.. code-block:: python

    @app.route('/')
    def index():
        return render_template('index.html')

    @app.route('/api/keypad-state')
    def keypad_state():
        with lock:
            return jsonify({
                'current_input': current_input,
                'history': keypad_history
            })

   - –°–æ–∑–¥–∞–µ–º endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
   - –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º

**–†–∞–∑–±–æ—Ä index.html:**

1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
   - –°–æ–∑–¥–∞–µ–º –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–∞: –¥–∏—Å–ø–ª–µ–π –≤–≤–æ–¥–∞ –∏ –∏—Å—Ç–æ—Ä–∏—è –Ω–∞–∂–∞—Ç–∏–π
   - –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –æ —Ñ—É–Ω–∫—Ü–∏—è—Ö –∫–ª–∞–≤–∏—à `*` –∏ `#`

2. **–°—Ç–∏–ª–∏ CSS:**
   - –û—Ñ–æ—Ä–º–ª—è–µ–º –¥–∏—Å–ø–ª–µ–π –≤–≤–æ–¥–∞ –≤ –≤–∏–¥–µ —Ç–µ–º–Ω–æ–≥–æ –º–æ–Ω–æ—Ö—Ä–æ–º–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
   - –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º—É—é –æ–±–ª–∞—Å—Ç—å –∏—Å—Ç–æ—Ä–∏–∏ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Å—Ç—Ä–æ–∫

3. **JavaScript-–ª–æ–≥–∏–∫–∞:**

.. code-block:: javascript

    function updateKeypadData() {
        fetch('/api/keypad-state')
            .then(response => response.json())
            .then(data => {
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –≤–≤–æ–¥ –∏ –∏—Å—Ç–æ—Ä–∏—é
            });
    }
   
   // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É
   setInterval(updateKeypadData, 1000);

   - –ò—Å–ø–æ–ª—å–∑—É–µ–º Fetch API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
   - –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É

–ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã
-----------------------------------------------------
1. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

.. code-block:: bash

    python3 lessons/keypad_web/app.py

3. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É: http://<IP_Raspberry_Pi>:5000
   - –≥–¥–µ <IP_Raspberry_Pi> - IP-–∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ Raspberry Pi –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏
   - –Ω–∞–ø—Ä–∏–º–µ—Ä: http://192.168.1.100:5000

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
---------------------------------------------------------
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –¥–∏—Å–ø–ª–µ–µ–º –≤–≤–æ–¥–∞ –∏ –∏—Å—Ç–æ—Ä–∏–µ–π –Ω–∞–∂–∞—Ç–∏–π. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–ª–∞–≤–∏—à –Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ:

1. –ù–∞ –¥–∏—Å–ø–ª–µ–µ –æ—Ç–æ–±—Ä–∞–∑—è—Ç—Å—è –Ω–∞–∂–∞—Ç—ã–µ —Å–∏–º–≤–æ–ª—ã
2. –í –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–∞–ø–∏—Å–∏ –æ –Ω–∞–∂–∞—Ç–∏—è—Ö
3. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ * –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –æ—á–∏—Å—Ç–∫–∞ –≤–≤–æ–¥–∞
4. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ # –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞

.. figure:: images/keypad_web_interface.png
   :width: 80%
   :align: center

   **–†–∏—Å. 2:** –ü—Ä–∏–º–µ—Ä –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –º–∞—Ç—Ä–∏—á–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
------------------------------------------------------------
–î–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ü–µ–ª–µ–π:

1. **–ö–æ–¥–æ–≤—ã–π –∑–∞–º–æ–∫**: –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É –≤–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–º –∑–∞–º–∫–æ–º
2. **–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –≤–≤–æ–¥–∞ PIN-–∫–æ–¥–æ–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º
3. **–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä**: –î–æ–±–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª
4. **–î–æ–º–∞—à–Ω—è—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: –£–ø—Ä–∞–≤–ª—è–π—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ —á–µ—Ä–µ–∑ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∫–æ–¥—ã
5. **–°–∏—Å—Ç–µ–º—ã —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
-----------------------------------------------------------
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –¥–æ—Å—Ç—É–ø–∞**: –î–æ–±–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º
2. **–ó–≤—É–∫–æ–≤–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å**: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –ø—å–µ–∑–æ—ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –∑–≤—É–∫–æ–≤–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–∞–∂–∞—Ç–∏–π
3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–ª–µ**: –î–æ–±–∞–≤—å—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∫–ª—é—á–∞—Ç—å/–≤—ã–∫–ª—é—á–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ –≤–≤–æ–¥—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∫–æ–¥–æ–≤
4. **–°–µ–∫—É–Ω–¥–æ–º–µ—Ä/—Ç–∞–π–º–µ—Ä**: –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ç–∞–π–º–µ—Ä–∞ —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
5. **–ñ—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –∏—Å—Ç–æ—Ä–∏—é –≤–≤–æ–¥–∞ –≤ —Ñ–∞–π–ª —Å –æ—Ç–º–µ—Ç–∫–∞–º–∏ –≤—Ä–µ–º–µ–Ω–∏

–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
------------------------------------------------------
–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –Ω–∞–∂–º–∏—Ç–µ **Ctrl + C** –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø–æ—Ç–æ–∫ –æ–ø—Ä–æ—Å–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –±–ª–∞–≥–æ–¥–∞—Ä—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é daemon-–ø–æ—Ç–æ–∫–∞.

–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! üéâ –í—ã —Å–æ–∑–¥–∞–ª–∏ —Å–∏—Å—Ç–µ–º—É –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–∞—Ç—Ä–∏—á–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –º–æ—â—å –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤–≤–æ–¥–∞ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –≤–µ–±-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏ –∏ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –æ—Å–Ω–æ–≤–æ–π –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —É–º–Ω–æ–≥–æ –¥–æ–º–∞ –∏–ª–∏ —Å–∏—Å—Ç–µ–º –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞.