============================================================
–£—Ä–æ–∫ 10: –ú–∞—Ç—Ä–∏—á–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ (CircuitPython) ‚å®Ô∏è
============================================================

–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å
-------------------
–ú–∞—Ç—Ä–∏—á–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ ‚Äì —ç—Ç–æ –Ω–∞–±–æ—Ä –∫–Ω–æ–ø–æ–∫, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ –º–∞—Ç—Ä–∏—Ü—ã —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤. –¢–∞–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∏–Ω–æ–≤ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –∫–Ω–æ–ø–æ–∫. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã 4x4 (16 –∫–Ω–æ–ø–æ–∫) —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—Å–µ–≥–æ 8 GPIO –ø–∏–Ω–æ–≤.

–í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º CircuitPython –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–∞—Ç—Ä–∏—á–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π 4x4, –∫–æ—Ç–æ—Ä–∞—è –∏–º–µ–µ—Ç 16 –∫–Ω–æ–ø–æ–∫ –∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–≤–æ–¥ —Ü–∏—Ñ—Ä –∏–ª–∏ –∫–æ–º–∞–Ω–¥.

–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
----------------------
- Raspberry Pi
- –ú–∞—Ç—Ä–∏—á–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ 4x4 (16 –∫–Ω–æ–ø–æ–∫)
- –°–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–æ–¥–∞
- –†–µ–∑–∏—Å—Ç–æ—Ä—ã 10 –∫–û–º –¥–ª—è –ø–æ–¥—Ç—è–∂–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
-----------------
.. figure:: images/klaviatura.jpg
   :width: 80%
   :align: center

   **–†–∏—Å. 1:** –°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –º–∞—Ç—Ä–∏—á–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
-------------------------------
–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –∫–æ–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–∞—Ç—Ä–∏—á–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π:

.. code-block:: bash

   pip install adafruit-circuitpython-matrixkeypad

–ó–∞–ø—É—Å–∫ –∫–æ–¥–∞
------------
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏–ª–∏ IDE (–Ω–∞–ø—Ä–∏–º–µ—Ä, Thonny –∏–ª–∏ VS Code) –Ω–∞ Raspberry Pi.
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª **keypad_circuit.py** –≤ –ø–∞–ø–∫–µ `lessons/lesson13/`.
3. –í—Å—Ç–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

–ö–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã
-------------
–§–∞–π–ª: `lessons/lesson10/keypad_circuit.py`

.. code-block:: python

    import time
    import board
    import digitalio
    import adafruit_matrixkeypad

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–∏–Ω—ã –¥–ª—è —Å—Ç—Ä–æ–∫ (R1-R4) –∏ —Å—Ç–æ–ª–±—Ü–æ–≤ (C1-C4)
    # –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –Ω–∞ –≤–∞—à–µ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è
    row_pins = [board.D5, board.D6, board.D13, board.D19]  # –ü–∏–Ω—ã –¥–ª—è —Å—Ç—Ä–æ–∫
    col_pins = [board.D12, board.D16, board.D20, board.D21]  # –ü–∏–Ω—ã –¥–ª—è —Å—Ç–æ–ª–±—Ü–æ–≤

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ä—Ç—É —Å–∏–º–≤–æ–ª–æ–≤ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    keys = [
        ["1", "2", "3", "A"],
        ["4", "5", "6", "B"],
        ["7", "8", "9", "C"],
        ["*", "0", "#", "D"]
    ]

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—á–Ω—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
    keypad = adafruit_matrixkeypad.Matrix_Keypad(
        row_pins, col_pins, keys
    )

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–∂–∞—Ç–∏–π
    last_pressed = []
    current_input = ""  # –°—Ç—Ä–æ–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤

    # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à
    def process_key_press(key):
        global current_input
        
        if key == "*":  # –ï—Å–ª–∏ –Ω–∞–∂–∞—Ç–∞ –∑–≤–µ–∑–¥–æ—á–∫–∞, –æ—á–∏—â–∞–µ–º –≤–≤–æ–¥
            current_input = ""
            print("–í–≤–æ–¥ –æ—á–∏—â–µ–Ω")
        elif key == "#":  # –ï—Å–ª–∏ –Ω–∞–∂–∞—Ç–∞ —Ä–µ—à–µ—Ç–∫–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–≤–æ–¥
            print(f"–í—ã –≤–≤–µ–ª–∏: {current_input}")
            # –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–≤–æ–¥–∞
            current_input = ""
        else:  # –û–±—ã—á–Ω–∞—è –∫–ª–∞–≤–∏—à–∞ - –¥–æ–±–∞–≤–ª—è–µ–º –∫ —Ç–µ–∫—É—â–µ–º—É –≤–≤–æ–¥—É
            current_input += key
            print(f"–ù–∞–∂–∞—Ç–∞ –∫–ª–∞–≤–∏—à–∞: {key}, –¢–µ–∫—É—â–∏–π –≤–≤–æ–¥: {current_input}")

    # –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª
    try:
        print("–ú–∞—Ç—Ä–∏—á–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ 4x4 –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!")
        print("'*' - –æ—á–∏—Å—Ç–∏—Ç—å –≤–≤–æ–¥, '#' - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤–≤–æ–¥")
        
        while True:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–∂–∞—Ç—ã–µ –∫–ª–∞–≤–∏—à–∏
            pressed = keypad.pressed_keys
            
            # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –Ω–∞–∂–∞—Ç–∏—è (—Ñ—Ä–æ–Ω—Ç —Å–∏–≥–Ω–∞–ª–∞)
            for key in pressed:
                if key not in last_pressed:
                    process_key_press(key)
            
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –Ω–∞–∂–∞—Ç—ã—Ö –∫–ª–∞–≤–∏—à
            last_pressed = pressed.copy()
            
            # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏
            time.sleep(0.1)
            
    except KeyboardInterrupt:
        print("\n–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.")


–†–∞–∑–±–æ—Ä –∫–æ–¥–∞
------------
- `row_pins` –∏ `col_pins` ‚Äì —Å–ø–∏—Å–∫–∏ —Å –Ω–æ–º–µ—Ä–∞–º–∏ GPIO –ø–∏–Ω–æ–≤, –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∫ —Å—Ç—Ä–æ–∫–∞–º –∏ —Å—Ç–æ–ª–±—Ü–∞–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.
- `keys` ‚Äì –¥–≤—É–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π —Å–∏–º–≤–æ–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–π –∫–Ω–æ–ø–∫–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∏—Ö —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º.
- `adafruit_matrixkeypad.Matrix_Keypad` ‚Äì –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.
- `keypad.pressed_keys` ‚Äì –º–µ—Ç–æ–¥, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ —Ç–µ–∫—É—â–∏—Ö –Ω–∞–∂–∞—Ç—ã—Ö –∫–ª–∞–≤–∏—à.
- `process_key_press()` ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à:
  - `*` ‚Äì –æ—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –≤–≤–æ–¥–∞
  - `#` ‚Äì –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–≤–æ–¥–∞
  - –î—Ä—É–≥–∏–µ –∫–ª–∞–≤–∏—à–∏ ‚Äì –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫ —Ç–µ–∫—É—â–µ–º—É –≤–≤–æ–¥—É
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –Ω–∞–∂–∞—Ç–∏–π —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –Ω–∞–∂–∞—Ç–∏–π (–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–∞).

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
-------------------
1. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–ª–∞–≤–∏—à–∏ 0-9, A-D —Å–∏–º–≤–æ–ª—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫ —Ç–µ–∫—É—â–µ–º—É –≤–≤–æ–¥—É.
2. –ù–∞–∂–∞—Ç–∏–µ `*` –æ—á–∏—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –≤–≤–æ–¥.
3. –ù–∞–∂–∞—Ç–∏–µ `#` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–≤–µ–¥–µ–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É.
4. –í –∫–æ–Ω—Å–æ–ª—å –≤—ã–≤–æ–¥–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –≤–≤–æ–¥–µ –∏ –≤—ã–ø–æ–ª–Ω—è–µ–º—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö.

.. note::
   –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ —Å–ø–æ—Å–æ–±–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –º–æ–≥—É—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –≤ –Ω—É–º–µ—Ä–∞—Ü–∏–∏ –ø–∏–Ω–æ–≤ –∏ —Ä–∞—Å–∫–ª–∞–¥–∫–µ –∫–ª–∞–≤–∏—à. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –≤–∞—à–µ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.

–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
-----------------
–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –Ω–∞–∂–º–∏—Ç–µ **Ctrl + C** –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! üéâ –í—ã —É—Å–ø–µ—à–Ω–æ –Ω–∞—É—á–∏–ª–∏—Å—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å –º–∞—Ç—Ä–∏—á–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π —Å –ø–æ–º–æ—â—å—é CircuitPython! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö, —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–¥–æ–≤—ã—Ö –∑–∞–º–∫–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–µ–Ω—é –∏ –¥—Ä—É–≥–∏—Ö –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.