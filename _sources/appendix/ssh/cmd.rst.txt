Установка встроенного SSH-клиента в Windows
======================================================

.. figure:: images/windows-ssh-banner.png
   :width: 80%
   :align: center
   
   **Рис. 1:** Встроенный SSH-клиент Windows

Что такое SSH и почему важен встроенный клиент
------------------------------------------------------------

SSH (Secure Shell) — это протокол, который обеспечивает безопасное удаленное подключение к устройствам через незащищенную сеть. Используя SSH, вы можете управлять своим Raspberry Pi с помощью командной строки, не подключая к нему монитор и клавиатуру.

Начиная с Windows 10 (версия 1809 и выше), Microsoft включила встроенный клиент SSH непосредственно в операционную систему. Это стало отличной альтернативой сторонним программам вроде PuTTY.

**Преимущества встроенного SSH-клиента:**

- Не требует установки дополнительного программного обеспечения
- Интегрирован в командную строку и PowerShell Windows
- Совместим с SSH-расширениями в редакторах кода (VS Code)
- Поддерживает современные стандарты безопасности
- Регулярно обновляется вместе с операционной системой

Проверка наличия SSH-клиента
------------------------------------

Перед установкой необходимо проверить, включен ли уже SSH-клиент в вашей системе:

1. Нажмите клавиши **Win + R**, введите ``cmd`` и нажмите Enter
2. В открывшейся командной строке введите:

   .. code-block:: bash

      ssh -V

3. Если команда не распознается или выводится сообщение об ошибке, SSH-клиент не установлен или не активирован.

   .. figure:: images/ssh-version-check.gif
      :width: 100%
      :align: center
      
      **Рис. 2:** Проверка версии SSH в командной строке

Если клиент установлен, вы увидите версию SSH

   .. figure:: images/ssh-version.png
      :width: 100%
      :align: center

      **Рис. 2:** Версия SSH в командной строке

Включение SSH-клиента в Windows
------------------------------------------

**Способ 1: Через настройки Windows**

1. Откройте **Параметры Windows** (Win + I)
2. Перейдите в раздел **Приложения → Дополнительные компоненты**
3. Нажмите **"Добавить компонент"**
4. Найдите в списке **"Клиент OpenSSH"** и выберите его
5. Нажмите **"Установить"**

   .. figure:: images/windows-optional-features.jpg
      :width: 80%
      :align: center
      
      **Рис. 3:** Добавление клиента OpenSSH через Дополнительные компоненты

**Способ 2: Через PowerShell (для администраторов)**

1. Откройте PowerShell от имени администратора (щелкните правой кнопкой мыши на меню "Пуск" → PowerShell (Admin))
2. Введите следующую команду и нажмите Enter:

   .. code-block:: powershell

      Add-WindowsCapability -Online -Name OpenSSH.Client~~~~0.0.1.0

3. Дождитесь завершения установки. Если операция прошла успешно, вы увидите сообщение:

   .. code-block:: text

      Path          :
      Online        : True
      RestartNeeded : False

Проверка работоспособности
----------------------------------

После установки проверьте, что SSH-клиент работает:

1. Откройте командную строку (cmd) или PowerShell
2. Введите команду `ssh -V`
3. Вы должны увидеть версию установленного SSH-клиента

Подключение к Raspberry Pi
----------------------------------

Для подключения к Raspberry Pi вам понадобится знать его IP-адрес в локальной сети. 

.. note::
   Подробные инструкции по определению IP-адреса Raspberry Pi можно найти в разделе :doc:`/appendix/getip/getip`.

После того, как вы узнали IP-адрес, выполните следующие шаги:

1. Откройте командную строку Windows или PowerShell
2. Введите команду для подключения:

   .. code-block:: bash

      ssh admin@192.168.8.X

   Где `192.168.8.X` - IP-адрес вашего Raspberry Pi, а `admin` - имя пользователя.

3. При первом подключении вы увидите предупреждение о неизвестном хосте. Введите `yes` для продолжения:

   .. figure:: images/ssh-first-connection.png
      :width: 80%
      :align: center
      
      **Рис. 4:** Предупреждение при первом подключении

4. Введите пароль (в нашем случае `admin`)
+
   .. note::
      При вводе пароля символы не отображаются — это нормально и сделано для повышения безопасности.

5. После успешной авторизации вы увидите приветствие системы Raspberry Pi OS:

   .. figure:: images/ssh-connected.png
      :width: 80%
      :align: center
      
      **Рис. 5:** Успешное подключение к Raspberry Pi

Основные команды SSH для работы с Raspberry Pi
--------------------------------------------------------------------

После подключения вы можете управлять Raspberry Pi с помощью команд Linux:

- ``ls`` - просмотр содержимого текущей директории
- ``cd /path/to/directory`` - переход в указанную директорию
- ``cd ..`` - переход на уровень выше
- ``python3 file.py`` - запуск Python-скрипта

Пример запуска первого кода через SSH:

.. code-block:: bash

   cd lessons/module1/lesson1
   python3 led.py

После выполнения этих команд светодиод, подключенный к GPIO18, начнет мигать согласно программе.

Для завершения выполнения программы нажмите **Ctrl+C**, а для выхода из SSH-сессии введите:

.. code-block:: bash

   exit

Возможные проблемы и их решения
------------------------------------------

**Проблема:** Ошибка "Connection refused"
   **Решение:** Убедитесь, что SSH включен на Raspberry Pi. Для этого выполните команду ``sudo raspi-config`` на Raspberry Pi и активируйте SSH в меню интерфейсов.

**Проблема:** Ошибка "Host key verification failed"
   **Решение:** Если IP-адрес Raspberry Pi изменился, но ранее вы уже подключались к нему, может возникнуть конфликт ключей. Удалите старую запись из файла ``known_hosts``:
   
   .. code-block:: bash

      ssh-keygen -R 192.168.1.X

**Проблема:** Ошибка таймаута подключения
   **Решение:** Проверьте, что Raspberry Pi и компьютер находятся в одной сети, и что брандмауэр Windows не блокирует подключение.

Заключение
----------------

Теперь у вас установлен и настроен встроенный SSH-клиент Windows, который позволяет удаленно управлять вашим Raspberry Pi через командную строку. Это базовый способ взаимодействия, который открывает большие возможности для удаленной работы.

В следующем уроке вы узнаете, как настроить Visual Studio Code для удобной работы с Raspberry Pi через SSH, что даст вам возможность использовать все преимущества современной IDE при разработке.